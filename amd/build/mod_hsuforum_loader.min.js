define(["jquery","core/ajax"],function(e,n){return registerPostsObserver=function(){const t=e(".hsuforum-post-wrapper"),o=e(".hsuforum-footer-reply")[0];null!=o&&t.push(o),t&&e(t).each(function(){new MutationObserver(()=>{let t=e(this).find("form");if(t){let o=e(t).find(".hsuforum-textarea");e(t).on("submit",()=>{if(0!=e(o).text()){document.cookie="Reply=yes";var t=e("input:hidden[name=reply]").val();n.call([{headers:"max-age=1000",methodname:"mod_hsuforum_mark_single_post_read",args:{postid:t},done:setTimeout(function(){var n=e(location).attr("href"),t=n.substr(n.lastIndexOf("&postid=")+8);e("#hsuforum-post-"+t).find("span.hsuforum-unreadcount").hide()},3e3)}])}})}}).observe(this,{subtree:!0,childList:!0})})},e(window).on("load",function(){document.cookie="Reply= ; expires = Thu, 01 Jan 1970 00:00:00 GMT"}),startSpinnerHandler=function(){e("#hsuforum-overlay-box").show(),e("#hsuforum-loading-container").show()},stopSpinnerHandler=function(){e("#hsuforum-overlay-box").hide(),e("#hsuforum-loading-container").hide()},registerSpinnerEvents=function(){const e=new Event("spinnerStartEvent"),n=new Event("spinnerStopEvent");window.spinnerStartEvent=e,window.spinnerStopEvent=n,document.body.addEventListener("spinnerStartEvent",()=>{startSpinnerHandler()}),document.body.addEventListener("spinnerStopEvent",()=>{stopSpinnerHandler()})},{init:function(){(function(e,n=0){const t=(new Date).getTime();return new Promise((o,r)=>{const s=setInterval(()=>{const i=(new Date).getTime();document.querySelector(e)?(clearInterval(s),o()):n&&i-t>=n&&(clearInterval(s),r())},100)})})("body",3e4).then(function(){e(".container :input").prop("disabled",!1),e(".mod-hsuforum-posts-container").show(),e("#hsuforum-loading-container").hide(),e("#hsuforum-overlay-box").hide(),window.hascompleted=!1;var n=window.location.hash;window.hascompleted||(n&&(e(n).closest("li").data("depth")>0&&e(n).closest(".posts-collapse-container").addClass("show").find(".posts-collapse-toggle.collapse-bottom").attr("aria-expanded","true"),e("html,body").animate({scrollTop:e(n).offset().top-60},1e3)),window.hascompleted=!0)}).catch(()=>{throw e(".container :input").prop("disabled",!1),e(".article").show(),e("#hsuforum-loading-container").hide(),e("#hsuforum-overlay-box").hide(),"element did not load in 30 seconds"}),registerPostsObserver(),registerSpinnerEvents()}}});
