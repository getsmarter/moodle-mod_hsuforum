define(["jquery","core/ajax","core/notification"],function(e,n,o){return registerPostsObserver=function(){const o=e(".hsuforum-post-wrapper"),t=e(".hsuforum-footer-reply")[0];null!=t&&o.push(t);o&&e(o).each(function(){new MutationObserver(()=>{let o=e(this).find("form");if(o){let t=e(o).find(".hsuforum-textarea");e(o).on("submit",()=>{if(0!=e(t).text()){var o=e("input:hidden[name=reply]").val();n.call([{headers:"max-age=1000",methodname:"mod_hsuforum_mark_single_post_read",args:{postid:o}}])[0].done(function(n){location.reload(),document.cookie="Reply=yes",setTimeout(function(){var n=e(location).attr("href"),o=n.substr(n.lastIndexOf("&postid=")+8);e("#hsuforum-post-"+o).find("span.hsuforum-unreadcount").hide()},3e3)}).fail(function(n){setTimeout(function(){e("#hsuforum-post-"+o).find("span.hsuforum-unreadcount").hide()},3e3)})}})}}).observe(this,{subtree:!0,childList:!0})})},window.onbeforeunload=function(){document.cookie="Reply= ; expires = Thu, 01 Jan 1970 00:00:00 GMT"},e("select.postratingmenu.ratinginput").change(function(){e(this).closest(".hsuforum-post-wrapper").find("span.hsuforum-unreadcount").hide()}),startSpinnerHandler=function(){e("#hsuforum-overlay-box").show(),e("#hsuforum-loading-container").show()},stopSpinnerHandler=function(){e("#hsuforum-overlay-box").hide(),e("#hsuforum-loading-container").hide()},registerSpinnerEvents=function(){const e=new Event("spinnerStartEvent"),n=new Event("spinnerStopEvent");window.spinnerStartEvent=e,window.spinnerStopEvent=n,document.body.addEventListener("spinnerStartEvent",()=>{startSpinnerHandler()}),document.body.addEventListener("spinnerStopEvent",()=>{stopSpinnerHandler()})},{init:function(){(function(e,n=0){const o=(new Date).getTime();return new Promise((t,r)=>{const s=setInterval(()=>{const i=(new Date).getTime();document.querySelector(e)?(clearInterval(s),t()):n&&i-o>=n&&(clearInterval(s),r())},100)})})("body",3e4).then(function(){e(".container :input").prop("disabled",!1),e(".mod-hsuforum-posts-container").show(),e("#hsuforum-loading-container").hide(),e("#hsuforum-overlay-box").hide(),window.hascompleted=!1;var n=window.location.hash;window.hascompleted||(n&&(e(n).closest("li").data("depth")>0&&e(n).closest(".posts-collapse-container").addClass("show").find(".posts-collapse-toggle.collapse-bottom").attr("aria-expanded","true"),e("html,body").animate({scrollTop:e(n).offset().top-60},1e3)),window.hascompleted=!0)}).catch(()=>{throw e(".container :input").prop("disabled",!1),e(".article").show(),e("#hsuforum-loading-container").hide(),e("#hsuforum-overlay-box").hide(),"element did not load in 30 seconds"}),registerPostsObserver(),registerSpinnerEvents()}}});
