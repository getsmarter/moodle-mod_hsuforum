{{=<% %>=}}

<div>
<!-- First post -->
    <%#firstpost%>
        <ion-list>
            <ion-item>
                <ion-avatar item-start><img src="<% profilesrc %>"></ion-avatar>
                <h2><% name %></h2>
                <h3>Topic by <% firstname %> <% lastname %></h3>
                    <p>
                        <span><% replycount %> <% replylabel %></span>
                    </p>
                <p>Firstpost message: <% message %></p>
                <!-- Button to show reply box -->
                <button
                    ion-button small style="float: left;"
                    *ngIf="!CONTENT_OTHERDATA.showform_<% id %>"
                    (click)="CONTENT_OTHERDATA.showform_<% id %> = !CONTENT_OTHERDATA.showform_<% id %>">
                    Reply
                </button>
            </ion-item>
        </ion-list>
        <!-- Form to reply to post -->
        <ion-card *ngIf="CONTENT_OTHERDATA.showform_<% id %>">
            <form #f="ngForm" id="postformid_<% id %>">
                <ion-textarea
                    item-content
                    ngControl="content"
                    name="postreplybody"
                    component="mod_hsuforum"
                    componentId="<% cmid %>"
                    placeholder="Type your reply...">
                </ion-textarea>
            </form>

            <!-- Form submit button -->
            <button
                ion-button small clear style="float: left;" type="submit" core-site-plugins-new-content 
                samePage=true
                refreshOnSuccess=true
                form="postformid_<% id %>"
                [args]="{'discussionid':<% discussionid %>, 'post':true, 'parentid':<% id %>}"
                (click)="CONTENT_OTHERDATA.showform_<% id %> = true"
                >
                Submit reply
            </button>

            <!-- Cancel button -->
            <button
                ion-button small clear style="float: left;"
                (click)="CONTENT_OTHERDATA.showform_<% id %> = false">
                Cancel
            </button>
        </ion-card>
    <%/firstpost%>

<!-- Replies(posts) on firstpost -->
    <ion-list>
        <ion-list-header>
            <p>
                <span><%^replycount%>0<%/replycount%> <% replycount %> <% replylabel %> for discussion</span>
            </p>
        </ion-list-header>
        <%#replies%>
            <ion-card>
                <ion-item>
                    <p><% message %></p>
                </ion-item>

                <!-- Form to reply to post -->
                <form #f="ngForm" id="postformid_<% id %>" *ngIf="CONTENT_OTHERDATA.showform_<% id %>">
                    <ion-card>
                        <ion-card-content>
                            <ion-textarea
                                item-content
                                ngControl="content"
                                name="postreplybody"
                                component="mod_hsuforum"
                                componentId="<% cmid %>">
                            </ion-textarea>
                        </ion-card-content>
                    </ion-card>
                </form>

                <!-- Form submit button -->
                <button
                    ion-button small clear style="float: left;" type="submit" core-site-plugins-new-content 
                    *ngIf="CONTENT_OTHERDATA.showform_<% id %>"
                    samePage=true
                    refreshOnSuccess=true
                    form="postformid_<% id %>"
                    [args]="{'discussionid':<% discussionid %>, 'post':true, 'parentid':<% id %>}"
                    (click)="CONTENT_OTHERDATA.showform_<% id %> = true"
                    >
                    Submit reply
                </button>

                <!-- Button to show reply box -->
                <button
                    ion-button small clear style="float: left;"
                    *ngIf="!CONTENT_OTHERDATA.showform_<% id %>"
                    (click)="CONTENT_OTHERDATA.showform_<% id %> = !CONTENT_OTHERDATA.showform_<% id %>">
                    Reply
                </button>

                <button
                    ion-button small clear style="float: right;" core-site-plugins-new-content
                    title="Replies for <% message %>"
                    component="mod_hsuforum" 
                    method="view_post_replies"
                    [args]="{'postid':<% id %>, 'discussionid':<% discussionid %>}">
                    View replies 
                </button>

            </ion-card>
        <%/replies%>
    </ion-list>
</div>
